<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Pig</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css  ">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 20px;
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 15px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            animation: bounce 1.5s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(to right, #ff9a9e, #fad0c4, #a1c4fd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            margin-top: 10px;
        }
        
        /* Main Content */
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            margin-bottom: 40px;
        }
        
        /* Game Container */
        #gameContainer {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        #gameContainer:hover {
            transform: scale(1.02);
        }
        
        #gameContainer::before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
        }
        
        #gameContainer::after {
            content: "";
            position: absolute;
            bottom: -60px;
            left: -40px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
        }
        
        canvas {
            border: 3px solid #4a5568;
            border-radius: 12px;
            display: block;
            margin: 20px auto;
            background: #87CEEB;
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            max-width: 100%;
            height: auto;
        }
        
        #score-container {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50px;
            font-weight: bold;
            color: #2d3748;
            font-size: 1.3rem;
        }
        
        #score, #highScore {
            min-width: 120px;
        }
        
        #gameOver {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 240, 240, 0.9);
            border-radius: 15px;
            border: 2px solid #fed7d7;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #gameOver h2 {
            color: #e53e3e;
            margin-bottom: 15px;
            font-size: 2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        #finalScore {
            color: #2d3748;
            font-size: 1.4rem;
            margin: 10px 0 20px;
            font-weight: bold;
        }
        
        button {
            background: linear-gradient(to right, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }
        
        button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }
        
        button:hover::after {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
            background: linear-gradient(to right, #45a049, #3d8b40);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        #instructions {
            margin: 15px 0;
            color: #4a5568;
            font-size: 1.1rem;
            font-weight: 500;
            padding: 12px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
            display: inline-block;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }
        
        /* Info Panel */
        .info-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
            color: #2d3748;
            align-self: center;
        }
        
        .info-panel h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #4a5568;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
            position: relative;
        }
        
        .info-panel h2::after {
            content: 'üê∑';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .feature {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.7);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .feature:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .feature i {
            font-size: 2.5rem;
            color: #4CAF50;
            margin-bottom: 15px;
            display: block;
        }
        
        .feature h3 {
            margin-bottom: 10px;
            color: #2d3748;
            font-size: 1.3rem;
        }
        
        .instructions-list {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .instructions-list h3 {
            margin-bottom: 15px;
            color: #2d3748;
            text-align: center;
            font-size: 1.5rem;
        }
        
        .instructions-list ul {
            padding-left: 20px;
            list-style-type: none;
        }
        
        .instructions-list li {
            margin: 12px 0;
            position: relative;
            padding-left: 30px;
            font-size: 1.05rem;
            line-height: 1.5;
        }
        
        .instructions-list li:before {
            content: "üê∑";
            position: absolute;
            left: 0;
            top: 0;
            font-size: 1.2rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            margin-top: auto;
            width: 100%;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .license {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 0.85rem;
            max-width: 800px;
            margin: 20px auto 0;
            line-height: 1.5;
        }
        
        .license h3 {
            margin-bottom: 10px;
            color: #a1c4fd;
            font-size: 1.1rem;
        }
        
        /* Responsive Design */
        @media (max-width: 900px) {
            .content {
                flex-direction: column;
                align-items: center;
            }
            
            h1 {
                font-size: 2.8rem;
            }
            
            .logo {
                font-size: 3.5rem;
            }
            
            .info-panel {
                max-width: 100%;
            }
        }
        
        @media (max-width: 500px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .logo {
                font-size: 2.8rem;
            }
            
            #score-container {
                flex-direction: column;
                gap: 8px;
                font-size: 1.1rem;
            }
            
            canvas {
                width: 95%;
                height: auto;
            }
            
            .license {
                padding: 12px;
                font-size: 0.8rem;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
        }
        
        /* Animation for pig letters */
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        
        .floating-pig {
            animation: float 3s ease-in-out infinite;
            display: inline-block;
            margin: 0 2px;
            font-weight: bold;
            color: #ff6b6b;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        
        .floating-pig:nth-child(2n) {
            animation-delay: 0.5s;
        }
        
        .floating-pig:nth-child(3n) {
            animation-delay: 1s;
        }
        
        /* Ground styling */
        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 15%;
            background: linear-gradient(to bottom, #8B4513, #A0522D);
            border-top: 5px solid #5D4037;
            z-index: 10;
        }
        
        .ground::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 0;
            width: 100%;
            height: 20px;
            background: linear-gradient(to bottom, transparent, #8FBC8F, #228B22);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üê∑</div>
            <h1>Flappy Pig</h1>
            <p class="subtitle">A delightful twist on the classic flappy game! Guide our adorable pig through the pipes with perfect timing.</p>
        </header>
        
        <div class="content">
            <div id="gameContainer">
                <div id="instructions">Click, tap or press SPACE to flap!</div>
                <div id="score-container">
                    <div id="score">Score: 0</div>
                    <div id="highScore">High: 0</div>
                </div>
                <canvas id="gameCanvas" width="400" height="600"></canvas>
                <div id="gameOver">
                    <h2><i class="fas fa-skull-crossbones"></i> Game Over! <i class="fas fa-skull-crossbones"></i></h2>
                    <p id="finalScore"></p>
                    <button onclick="resetGame()">
                        <i class="fas fa-redo"></i> Play Again
                    </button>
                    <button onclick="toggleMute()">
                        <i class="fas fa-volume-up" id="muteIcon"></i> <span id="muteText">Mute Sound</span>
                    </button>
                </div>
            </div>
            
            <div class="info-panel">
                <h2>About Flappy Pig</h2>
                <p style="text-align: center; line-height: 1.6; margin-bottom: 25px;">
                    Help our pink friend navigate through the green pipes! The game gets progressively harder as your score increases.
                </p>
                
                <div class="features">
                    <div class="feature">
                        <i class="fas fa-mobile-alt"></i>
                        <h3>Mobile Friendly</h3>
                        <p>Play anywhere with touch support</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-bolt"></i>
                        <h3>Optimized</h3>
                        <p>Smooth performance on all devices</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-piggy-bank"></i>
                        <h3>Adorable</h3>
                        <p>Meet your new favorite gaming pig!</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-trophy"></i>
                        <h3>High Scores</h3>
                        <p>Compete with yourself for the top score</p>
                    </div>
                </div>
                
                <div class="instructions-list">
                    <h3>How to Play</h3>
                    <ul>
                        <li>Press SPACE, CLICK, or TAP to make the pig flap</li>
                        <li>Navigate through the pipes without hitting them</li>
                        <li>Each pipe passed earns you 1 point</li>
                        <li>Try to beat your high score!</li>
                        <li>Game gets faster as your score increases</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer>
            <p>¬© 2026 Flappy Pig group | Made with ‚ù§Ô∏è for pig lovers everywhere</p>
            <p>All rights reserved. This game is a fan creation and not affiliated with any official pig organization.</p>
            
            <div class="license">
                <h3>MIT License</h3>
                <p>Copyright (c) 2026 Flappy Pig group</p>
                <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
                <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
                <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
            </div>
        </footer>
    </div>

    <script>
        // Game script with all improvements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const muteIcon = document.getElementById('muteIcon');
        const muteText = document.getElementById('muteText');
        
        // Game variables
        let pig = {
            x: 100,
            y: canvas.height / 2,
            width: 50,
            height: 35,
            velocity: 0,
            gravity: 0.6,
            jumpPower: -10,
            rotation: 0
        };
        
        let pipes = [];
        let clouds = [];
        let score = 0;
        let gameRunning = true;
        let frameCount = 0;
        let highScore = localStorage.getItem('flappyPigHighScore') || 0;
        let isMuted = false;
        let pipeSpeed = 2;
        let lastPipeTime = 0;
        const pipeGap = 180;
        const minPipeHeight = 80;
        const maxPipeHeight = canvas.height - pipeGap - minPipeHeight - 100; // 100px for ground
        
        // Initialize high score display
        document.getElementById('highScore').textContent = `High: ${highScore}`;
        
        // Create clouds
        function initClouds() {
            for (let i = 0; i < 5; i++) {
                clouds.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * (canvas.height / 2),
                    width: Math.random() * 60 + 40,
                    height: Math.random() * 25 + 15,
                    speed: Math.random() * 0.5 + 0.1
                });
            }
        }
        
        // Create pipe
        function createPipe() {
            const height = Math.random() * (maxPipeHeight - minPipeHeight) + minPipeHeight;
            
            pipes.push({
                x: canvas.width,
                topHeight: height,
                bottomY: height + pipeGap,
                width: 70,
                passed: false
            });
        }
        
        // Draw pig facing RIGHT (flipped version)
        function drawPig() {
            ctx.save();
            ctx.translate(pig.x, pig.y);
            
            // FLIP HORIZONTALLY to face right
            ctx.scale(-1, 1);
            
            // Calculate rotation based on velocity (negated for flip)
            pig.rotation = pig.velocity * 0.1;
            ctx.rotate(-pig.rotation);
            
            // Pig body
            ctx.fillStyle = '#FFB6C1';
            ctx.beginPath();
            ctx.ellipse(0, 0, pig.width/2, pig.height/2, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Pig snout (now on RIGHT side due to flip)
            ctx.fillStyle = '#FF69B4';
            ctx.beginPath();
            ctx.ellipse(-15, 5, 18, 12, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Pig nostrils
            ctx.fillStyle = '#FF1493';
            ctx.beginPath();
            ctx.arc(-20, 8, 3, 0, Math.PI * 2);
            ctx.arc(-25, 8, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Pig eyes (flipped positions)
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(5, -5, 8, 0, Math.PI * 2);
            ctx.arc(-8, -5, 8, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(7, -6, 4, 0, Math.PI * 2);
            ctx.arc(-6, -6, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // Pig ears (flipped positions)
            ctx.fillStyle = '#FF69B4';
            ctx.beginPath();
            ctx.ellipse(15, -15, 12, 20, 0.5, 0, Math.PI * 2);
            ctx.ellipse(-15, -15, 12, 20, -0.5, 0, Math.PI * 2);
            ctx.fill();
            
            // Pig tail (now on LEFT side due to flip)
            ctx.strokeStyle = '#FF69B4';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(25, 5);
            ctx.quadraticCurveTo(40, -10, 35, -20);
            ctx.stroke();
            
            ctx.restore();
        }
        
        // Draw pipes with improved graphics
        function drawPipes() {
            pipes.forEach(pipe => {
                // Top pipe
                ctx.fillStyle = '#228B22';
                ctx.fillRect(pipe.x, 0, pipe.width, pipe.topHeight);
                
                // Pipe cap
                ctx.fillStyle = '#32CD32';
                ctx.fillRect(pipe.x - 5, pipe.topHeight - 25, pipe.width + 10, 25);
                
                // Bottom pipe
                ctx.fillStyle = '#228B22';
                ctx.fillRect(pipe.x, pipe.bottomY, pipe.width, canvas.height - pipe.bottomY);
                
                // Pipe cap
                ctx.fillStyle = '#32CD32';
                ctx.fillRect(pipe.x - 5, pipe.bottomY, pipe.width + 10, 25);
                
                // Pipe stripes
                ctx.fillStyle = '#1E7D1E';
                for (let y = 20; y < pipe.topHeight; y += 30) {
                    ctx.fillRect(pipe.x + 5, y, pipe.width - 10, 5);
                }
                for (let y = pipe.bottomY + 20; y < canvas.height; y += 30) {
                    ctx.fillRect(pipe.x + 5, y, pipe.width - 10, 5);
                }
            });
        }
        
        // Draw clouds
        function drawClouds() {
            clouds.forEach(cloud => {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                ctx.beginPath();
                ctx.arc(cloud.x, cloud.y, cloud.height/2, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width/3, cloud.y - cloud.height/4, cloud.height/2.5, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width*2/3, cloud.y, cloud.height/2.2, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width/2, cloud.y + cloud.height/4, cloud.height/2.8, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        // Draw ground
        function drawGround() {
            const groundHeight = canvas.height * 0.15;
            const groundY = canvas.height - groundHeight;
            
            // Ground
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, groundY, canvas.width, groundHeight);
            
            // Grass
            ctx.fillStyle = '#228B22';
            ctx.fillRect(0, groundY - 20, canvas.width, 20);
            
            // Ground details
            ctx.fillStyle = '#A0522D';
            for (let i = 0; i < canvas.width; i += 30) {
                ctx.fillRect(i, groundY + 5, 20, 5);
            }
        }
        
        // Play sound effect
        function playSound(type) {
            if (isMuted) return;
            
            let audio;
            switch(type) {
                case 'jump':
                    audio = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=');
                    audio.volume = 0.3;
                    break;
                case 'score':
                    audio = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=');
                    audio.volume = 0.2;
                    break;
                case 'hit':
                    audio = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=');
                    audio.volume = 0.4;
                    break;
                default:
                    return;
            }
            
            // Create a short beep sound dynamically
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            switch(type) {
                case 'jump':
                    oscillator.frequency.value = 600;
                    gainNode.gain.value = 0.1;
                    oscillator.type = 'sine';
                    break;
                case 'score':
                    oscillator.frequency.value = 800;
                    gainNode.gain.value = 0.08;
                    oscillator.type = 'sine';
                    break;
                case 'hit':
                    oscillator.frequency.value = 200;
                    gainNode.gain.value = 0.2;
                    oscillator.type = 'square';
                    break;
            }
            
            oscillator.start();
            setTimeout(() => {
                oscillator.stop();
            }, type === 'hit' ? 200 : 100);
        }
        
        // Update game state
        function update(timestamp) {
            // Handle jump input buffering
            if (jumpBuffer > 0) {
                jumpBuffer--;
                if (gameRunning) {
                    pig.velocity = pig.jumpPower;
                    playSound('jump');
                }
            }
            
            if (!gameRunning) return;
            
            frameCount++;
            
            // Update pig
            pig.velocity += pig.gravity;
            pig.y += pig.velocity;
            
            // Increase difficulty based on score
            pipeSpeed = 2 + Math.min(score / 10, 3); // Max speed increase of 3
            
            // Create new pipes
            if (!lastPipeTime || timestamp - lastPipeTime > 1500) {
                createPipe();
                lastPipeTime = timestamp;
            }
            
            // Update pipes
            for (let i = pipes.length - 1; i >= 0; i--) {
                const pipe = pipes[i];
                pipe.x -= pipeSpeed;
                
                // Check if pipe is passed
                if (!pipe.passed && pipe.x + pipe.width < pig.x) {
                    pipe.passed = true;
                    score++;
                    document.getElementById('score').textContent = `Score: ${score}`;
                    playSound('score');
                    
                    // Update high score
                    if (score > highScore) {
                        highScore = score;
                        localStorage.setItem('flappyPigHighScore', highScore);
                        document.getElementById('highScore').textContent = `High: ${highScore}`;
                    }
                }
                
                // Remove off-screen pipes
                if (pipe.x + pipe.width < 0) {
                    pipes.splice(i, 1);
                }
            }
            
            // Update clouds
            clouds.forEach(cloud => {
                cloud.x -= cloud.speed;
                if (cloud.x + cloud.width < 0) {
                    cloud.x = canvas.width + cloud.width;
                    cloud.y = Math.random() * (canvas.height / 2.5);
                }
            });
            
            // Check collisions
            checkCollisions();
        }
        
        // Check collisions
        function checkCollisions() {
            const groundHeight = canvas.height * 0.15;
            const groundY = canvas.height - groundHeight;
            
            // Ground and ceiling collision
            if (pig.y - pig.height/2 <= 0 || pig.y + pig.height/2 >= groundY) {
                gameOver();
                return;
            }
            
            // Pipe collisions
            pipes.forEach(pipe => {
                // Create bounding boxes
                const pigBox = {
                    x: pig.x - pig.width/2,
                    y: pig.y - pig.height/2,
                    width: pig.width,
                    height: pig.height
                };
                
                const topPipeBox = {
                    x: pipe.x,
                    y: 0,
                    width: pipe.width,
                    height: pipe.topHeight
                };
                
                const bottomPipeBox = {
                    x: pipe.x,
                    y: pipe.bottomY,
                    width: pipe.width,
                    height: canvas.height - pipe.bottomY
                };
                
                // Check collision with top pipe
                if (checkCollision(pigBox, topPipeBox)) {
                    gameOver();
                    return;
                }
                
                // Check collision with bottom pipe
                if (checkCollision(pigBox, bottomPipeBox)) {
                    gameOver();
                    return;
                }
            });
        }
        
        // Check if two rectangles collide
        function checkCollision(rect1, rect2) {
            return (
                rect1.x < rect2.x + rect2.width &&
                rect1.x + rect1.width > rect2.x &&
                rect1.y < rect2.y + rect2.height &&
                rect1.y + rect1.height > rect2.y
            );
        }
        
        // Game over
        function gameOver() {
            gameRunning = false;
            playSound('hit');
            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('finalScore').textContent = `Final Score: ${score} | High Score: ${highScore}`;
        }
        
        // Reset game
        function resetGame() {
            pig.y = canvas.height / 2;
            pig.velocity = 0;
            pig.rotation = 0;
            pipes = [];
            score = 0;
            frameCount = 0;
            jumpBuffer = 0;
            gameRunning = true;
            document.getElementById('score').textContent = 'Score: 0';
            document.getElementById('gameOver').style.display = 'none';
            lastPipeTime = 0;
        }
        
        // Toggle mute
        function toggleMute() {
            isMuted = !isMuted;
            muteIcon.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
            muteText.textContent = isMuted ? 'Unmute Sound' : 'Mute Sound';
        }
        
        // Draw everything
        function draw() {
            // Clear canvas
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw clouds
            drawClouds();
            
            // Draw pipes
            drawPipes();
            
            // Draw ground
            drawGround();
            
            // Draw pig
            drawPig();
        }
        
        // Game loop
        let jumpBuffer = 0;
        const JUMP_BUFFER_FRAMES = 5;
        let lastTimestamp = 0;
        
        function gameLoop(timestamp) {
            // Calculate delta time for consistent animation
            const deltaTime = timestamp - lastTimestamp;
            lastTimestamp = timestamp;
            
            update(timestamp);
            draw();
            
            requestAnimationFrame(gameLoop);
        }
        
        // Controls
        function jump() {
            if (gameRunning) {
                pig.velocity = pig.jumpPower;
                playSound('jump');
            } else {
                // Restart game if it's over
                resetGame();
            }
        }
        
        canvas.addEventListener('click', jump);
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.key === ' ') {
                e.preventDefault();
                jump();
            }
        });
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });
        
        // Initialize and start
        initClouds();
        gameLoop(0);
        
        // Add floating pig animation to title
        document.addEventListener('DOMContentLoaded', () => {
            const title = document.querySelector('h1');
            const text = title.textContent;
            title.innerHTML = '';
            
            for (let i = 0; i < text.length; i++) {
                if (text[i] === ' ') {
                    title.innerHTML += '&nbsp;';
                } else {
                    title.innerHTML += `<span class="floating-pig">${text[i]}</span>`;
                }
            }
            
            // Add ground element
            const ground = document.createElement('div');
            ground.className = 'ground';
            document.getElementById('gameContainer').appendChild(ground);
        });
    </script>
</body>
</html>
